/*
 * @Descripttion: table 组件样式
 * @creater: zhengpeng.ren
 * @since: 2025-02-18
 */
@import '../../styles/mixins/bem.mixin.scss';
@import '../../styles/mixins/index.mixin.scss';

:host {
  display: block;
}

@include b(table) {
  width: 100%;

  @include e(wrapper) {
    width: 100%;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  @include e(header-wrapper) {
    flex-shrink: 0;
    overflow: hidden;
  }

  @include e(body-wrapper) {
    flex: 1;
    min-height: 0;
    overflow: auto;

    /* 虚拟滚动：固定高度不随内容撑开，滚动在内部 body-inner */
    &--virtual {
      flex: 0 0 auto;
      overflow: hidden;
    }
  }

  @include e(header) {
    width: 100%;
    display: table;
    table-layout: fixed;
    border-collapse: collapse;
    background-color: var(--nv-table-header-background-color, #f5f7fa);

    .nv-table__row {
      height: var(--nv-table-header-height, 40px);
    }
  }

  @include e(header-cell) {
    display: table-cell;
    padding: var(--nv-table-cell-padding, 12px 0);
    padding-left: 12px;
    padding-right: 12px;
    text-align: left;
    font-size: var(--nv-table-header-font-size, 14px);
    font-weight: var(--nv-table-header-font-weight, 500);
    color: var(--nv-table-header-text-color, #909399);
    box-sizing: border-box;

    &.is-left {
      text-align: left;
    }
    &.is-center {
      text-align: center;
    }
    &.is-right {
      text-align: right;
    }
  }

  @include e(sortable) {
    cursor: pointer;
    user-select: none;
  }

  @include e(sort-icon) {
    margin-left: 4px;
    display: inline-block;
    vertical-align: middle;
    transition: opacity 0.2s;
    opacity: 0.4;

    .nv-table__header-cell:hover &,
    .nv-table__sortable.is-asc &,
    .nv-table__sortable.is-desc & {
      opacity: 1;
    }
  }

  @include e(body) {
    width: 100%;
    display: table;
    table-layout: fixed;
    border-collapse: collapse;
  }

  @include e(body-inner) {
    width: 100%;
    display: table;
    table-layout: fixed;
    border-collapse: collapse;
  }

  /* 虚拟模式：块级滚动容器，高度受 body-wrapper 限制，列宽由组件内 _getResolvedColumns() 解析 */
  @include e(body--virtual) {
    display: block;
    box-sizing: border-box;
  }

  @include e(row) {
    display: table-row;
    height: var(--nv-table-row-height, 40px);
    transition: background-color 0.2s;

    &:hover {
      background-color: var(--nv-table-row-background-color-hover, #f5f7fa);
    }

    &.is-current-row {
      background-color: var(--nv-table-row-background-color-current, #ecf5ff);
    }
  }

  @include e(cell) {
    display: table-cell;
    padding: var(--nv-table-cell-padding, 12px 0);
    padding-left: 12px;
    padding-right: 12px;
    font-size: var(--nv-table-cell-font-size, 14px);
    color: var(--nv-table-cell-text-color, #606266);
    box-sizing: border-box;

    &.is-left {
      text-align: left;
    }
    &.is-center {
      text-align: center;
    }
    &.is-right {
      text-align: right;
    }
  }

  @include e(empty) {
    display: block !important;
    text-align: center;
    padding: 40px 0;
    width: 100%;
  }

  @include e(empty-text) {
    font-size: var(--nv-table-empty-text-font-size, 14px);
    color: var(--nv-table-empty-text-color, #909399);
  }

  /* size modifiers：覆盖行高、表头高度、内边距、字体等变量 */
  &.is-mini {
    --nv-table-row-height: var(--nv-table-row-height-mini);
    --nv-table-header-height: var(--nv-table-header-height-mini);
    --nv-table-header-font-size: var(--nv-table-header-font-size-mini);
    --nv-table-cell-padding: var(--nv-table-cell-padding-mini);
    --nv-table-cell-font-size: var(--nv-table-cell-font-size-mini);
    --nv-table-empty-text-font-size: var(--nv-table-empty-text-font-size-mini);
  }
  &.is-small {
    --nv-table-row-height: var(--nv-table-row-height-small);
    --nv-table-header-height: var(--nv-table-header-height-small);
    --nv-table-header-font-size: var(--nv-table-header-font-size-small);
    --nv-table-cell-padding: var(--nv-table-cell-padding-small);
    --nv-table-cell-font-size: var(--nv-table-cell-font-size-small);
    --nv-table-empty-text-font-size: var(--nv-table-empty-text-font-size-small);
  }
  &.is-medium {
    --nv-table-row-height: var(--nv-table-row-height-medium);
    --nv-table-header-height: var(--nv-table-header-height-medium);
    --nv-table-header-font-size: var(--nv-table-header-font-size-medium);
    --nv-table-cell-padding: var(--nv-table-cell-padding-medium);
    --nv-table-cell-font-size: var(--nv-table-cell-font-size-medium);
    --nv-table-empty-text-font-size: var(--nv-table-empty-text-font-size-medium);
  }
  &.is-large {
    --nv-table-row-height: var(--nv-table-row-height-large);
    --nv-table-header-height: var(--nv-table-header-height-large);
    --nv-table-header-font-size: var(--nv-table-header-font-size-large);
    --nv-table-cell-padding: var(--nv-table-cell-padding-large);
    --nv-table-cell-font-size: var(--nv-table-cell-font-size-large);
    --nv-table-empty-text-font-size: var(--nv-table-empty-text-font-size-large);
  }
  &.is-huge {
    --nv-table-row-height: var(--nv-table-row-height-huge);
    --nv-table-header-height: var(--nv-table-header-height-huge);
    --nv-table-header-font-size: var(--nv-table-header-font-size-huge);
    --nv-table-cell-padding: var(--nv-table-cell-padding-huge);
    --nv-table-cell-font-size: var(--nv-table-cell-font-size-huge);
    --nv-table-empty-text-font-size: var(--nv-table-empty-text-font-size-huge);
  }

  /* modifiers：modifier 内 @include e(x) 会生成 .nv-table.is-modifier__x，无法匹配 .nv-table__x，故用后代选择器 */
  &.is-border {
    /* 最右侧边框放在 wrapper 上，横向滚动时始终贴在视口右缘；最后一列 cell 不再画右边线避免重复 */
    .nv-table__header-wrapper {
      border-right: var(--nv-table-border-width, 1px) solid var(--nv-table-border-color, #ebeef5);
    }
    .nv-table__body-wrapper {
      border-right: var(--nv-table-border-width, 1px) solid var(--nv-table-border-color, #ebeef5);
    }
    .nv-table__header-cell {
      border-top: var(--nv-table-border-width, 1px) solid var(--nv-table-border-color, #ebeef5);
      border-bottom: var(--nv-table-border-width, 1px) solid var(--nv-table-border-color, #ebeef5);
      border-right: var(--nv-table-border-width, 1px) solid var(--nv-table-border-color, #ebeef5);

      &:first-child {
        border-left: var(--nv-table-border-width, 1px) solid var(--nv-table-border-color, #ebeef5);
      }
      &:last-child {
        border-right: none;
      }
    }
    .nv-table__cell {
      border-bottom: var(--nv-table-border-width, 1px) solid var(--nv-table-border-color, #ebeef5);
      border-right: var(--nv-table-border-width, 1px) solid var(--nv-table-border-color, #ebeef5);

      &:first-child {
        border-left: var(--nv-table-border-width, 1px) solid var(--nv-table-border-color, #ebeef5);
      }
      &:last-child {
        border-right: none;
      }
    }
  }

  &.is-stripe {
    /* 使用后代选择器：BEM 在 modifier 内 @include e(row) 会生成 .nv-table.is-stripe__row，无法匹配 .nv-table__row */
    .nv-table__row {
      background-color: var(--nv-table-row-background-color, #fff);

      &:nth-child(even) {
        background-color: var(--nv-table-row-background-color-stripe, #fafafa);
      }
      &:hover {
        background-color: var(--nv-table-row-background-color-hover, #f5f7fa);
      }
      &.is-current-row {
        background-color: var(--nv-table-row-background-color-current, #ecf5ff);
      }
    }
  }
}
